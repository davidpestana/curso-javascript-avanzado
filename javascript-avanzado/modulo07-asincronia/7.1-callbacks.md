# 7.1 Callbacks (Asincronía con funciones)

## 🧠 ¿Qué es la asincronía?

En JavaScript algunas operaciones **no suceden en el momento**, como:

* Consultas al servidor (fetch)
* Leer archivos
* Temporizadores (setTimeout)
* Eventos del usuario
* Animaciones

Mientras espera una respuesta, JavaScript **no se bloquea**. Sigue ejecutando otras cosas y, cuando termina la operación, llama a **un callback**.

---

## 🔧 ¿Qué es un callback asincrónico?

Es una función que se ejecuta **más tarde**, cuando algo termina.

```js
console.log("Inicio");

setTimeout(() => {
  console.log("Esto se ejecuta después");
}, 2000);

console.log("Final");
```

Salida:

```
Inicio
Final
Esto se ejecuta después
```

---

## ✅ setTimeout y setInterval

```js
setTimeout(() => {
  console.log("Esto se retrasa 1 segundo");
}, 1000);

let n = 0;
setInterval(() => {
  n++;
  console.log("Cada segundo:", n);
}, 1000);
```

---

## ⚠️ Problema real: Callback Hell 😵

Cuando anidas muchos callbacks, tu código pierde claridad.

```js
getUser(1, user => {
  getPosts(user.id, posts => {
    getComments(posts[0].id, comments => {
      console.log(comments);
    });
  });
});
```

Esto se conoce como **callback hell** porque es difícil de leer y mantener. Más adelante aprenderemos a evitarlo usando **promesas** y **async/await**.

---

# 🛠 Laboratorio

## 🎯 Objetivos

* Entender callbacks asincrónicos
* Usar setTimeout y setInterval
* Controlar la ejecución en el tiempo

---

### Ejercicio 1 — Mensaje con retraso

```js
setTimeout(() => {
  console.log("Esto aparece después de 2 segundos");
}, 2000);
```

---

### Ejercicio 2 — Contador cada segundo

```js
let contador = 1;
const id = setInterval(() => {
  console.log("Segundo:", contador);
  contador++;
  if (contador > 5) clearInterval(id);
}, 1000);
```

---

### Ejercicio 3 — Callback como parámetro

```js
function ejecutarDespues(mensaje, callback) {
  console.log(mensaje);
  callback();
}

ejecutarDespues("Primero esto", () => {
  console.log("Luego esto");
});
```

---

### Ejercicio 4 — Simular carga de datos

```js
function obtenerDatos(callback) {
  console.log("Cargando datos...");
  setTimeout(() => {
    callback({ nombre: "Ada", edad: 36 });
  }, 1500);
}

obtenerDatos((datos) => {
  console.log("Datos recibidos:", datos);
});
```

---

### Ejercicio 5 — Mini callback hell

```js
setTimeout(() => {
  console.log("Paso 1");
  setTimeout(() => {
    console.log("Paso 2");
    setTimeout(() => {
      console.log("Paso 3");
    }, 500);
  }, 500);
}, 500);
```

---

## 🚀 Retos

1. Simula un "cargando...", luego muestra datos reales tras 2 segundos.
2. Haz una función `esperar(ms, callback)` que ejecute algo después de ms milisegundos.
3. Crea un temporizador con inicio/parada usando callbacks.