# 9.4 Closures

## 🧠 ¿Qué es un closure?

Un **closure** es cuando una función **recuerda el contexto en el que fue creada**, incluso después de que ese contexto haya terminado de ejecutarse.

➡️ En otras palabras: **una función interna puede acceder a variables de la función externa, aunque esta ya haya terminado**.

---

## ✅ Ejemplo básico

```js
function saludar(nombre) {
  return function () {
    console.log("Hola " + nombre);
  };
}

const saludo = saludar("Ana");
saludo(); // Hola Ana
```

Aunque `saludar()` ya terminó, la función interna **recuerda** el valor de `nombre`. Eso es un **closure**.

---

## 🔒 Closures para variables privadas

```js
function contador() {
  let valor = 0;
  return function () {
    valor++;
    return valor;
  };
}

const incrementar = contador();
incrementar(); // 1
incrementar(); // 2
incrementar(); // 3
```

`valor` está **encerrado** dentro del closure. Nadie puede modificarlo desde fuera.

---

## ⚙️ Funciones que generan funciones

```js
function crearMultiplicador(factor) {
  return function (numero) {
    return numero * factor;
  };
}

const por3 = crearMultiplicador(3);
por3(10); // 30
```

---

## 🛡️ Encapsulación real con closure

```js
function crearCuenta() {
  let saldo = 0;
  return {
    depositar(monto) { saldo += monto; },
    verSaldo() { return saldo; }
  };
}
const cuenta = crearCuenta();
cuenta.depositar(100);
cuenta.verSaldo(); // 100
```

---

# 🛠 Laboratorio

## 🎯 Objetivos

* Entender cómo funciona la memoria de JavaScript
* Usar closures para encapsular datos
* Crear funciones generadoras y factories

---

### Ejercicio 1 — Closure simple

```js
function crearSaludo(nombre) {
  return function () {
    console.log("Hola " + nombre);
  };
}
const saludo = crearSaludo("Carlos");
saludo();
```

---

### Ejercicio 2 — Contador con variable privada

```js
function crearContador() {
  let c = 0;
  return function () {
    c++;
    return c;
  };
}
const contar = crearContador();
contar(); // 1
contar(); // 2
```

---

### Ejercicio 3 — Factory con closure

```js
function multiplicador(factor) {
  return function (num) {
    return num * factor;
  };
}
const doble = multiplicador(2);
doble(5); // 10
```

---

### Ejercicio 4 — Acceso restringido

```js
function crearUsuario(nombre) {
  let logins = 0;
  return {
    login() { logins++; },
    getLogins() { return logins; }
  };
}
```

---

### Ejercicio 5 — Caché con closure

```js
function memoizar(fn) {
  const cache = {};
  return function(n) {
    if (cache[n]) return cache[n];
    const resultado = fn(n);
    cache[n] = resultado;
    return resultado;
  };
}
```

---

## 🚀 Retos

1. Crea `temporizador()` que permita iniciar, pausar y ver segundos, usando closure.
2. Implementa `crearLista()` con métodos `agregar`, `remover`, `listar` sin exponer el array.
3. Haz un "logger" configurable con closure que acepte un prefijo como `[INFO]`.